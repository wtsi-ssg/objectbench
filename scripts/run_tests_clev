[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm"

export OBJECTBENCH_DB_USER=objectbench
export OBJECTBENCH_DB_PASS=objectbench
export OBJECTBENCH_DB_HOST=172.22.3.217
export OBJECTBENCH_REDIS_HOST=172.22.3.217
export OBJECTBENCH_REDIS_PORT=6379
export OBJECTBENCH_TAG="Test_run_$$"
# These are the distribution of file sizes in powers of 10 
# 1-9: 86
# 10-99 : 103
export OBJECTBENCH_INITAL_DISTRIBUTION="86, 103, 68, 113, 588, 405, 140, 29, 137, 117, 3"
export OBJECTBENCH_INITAL_DISTRIBUTION="86, 103"
# This is the distribution of file sizes in the main test
export OBJECTBENCH_TEST_WRITE_DISTRIBUTION="$OBJECTBENCH_INITAL_DISTRIBUTION"
# This is the distribution of Write,reads and partial reads
export OBJECTBENCH_TEST_WORKLOAD_DISTRIBUTION="600,300,100"

echo "Tagging tests as ${OBJECTBENCH_TAG}"
export FILE_TEST="CleverSafe"
cd /nfs/users/nfs_j/jb23/src/object_bench
bundle exec rake add_initial_writes
bundle exec rake wait_for_stable
bundle exec rake load_tests
echo "Test Tagged as ${OBJECTBENCH_TAG}"
bundle exec rake wait_for_stable
echo "Test Tagged as ${OBJECTBENCH_TAG}"
